from django.db import migrations

def populate_places(apps, schema_editor):
    Place = apps.get_model('tourism', 'Place')
    City = apps.get_model('tourism', 'City')
    Category = apps.get_model('tourism', 'Category')

    # Helper function to safely get IDs
    def create_place(title, city_name, cat_name, lat, lon):
        try:
            city = City.objects.get(name=city_name)
            category = Category.objects.get(name=cat_name)
            
            # Check duplicates based on title and city
            if not Place.objects.filter(title=title, city=city).exists():
                Place.objects.create(
                    title=title,
                    description=f"{title} یکی از جاذبه‌های گردشگری برجسته‌ی {city_name} است.",
                    city=city,
                    category=category,
                    latitude=lat,
                    longitude=lon
                )
        except Exception as e:
            print(f"Skipping {title}: {e}")

    # Data List: (Title, City Name, Category Name, Latitude, Longitude)
    places_data = [
        # Fars
        ('تخت جمشید', 'مرودشت', 'تاریخی', 29.9357, 52.8914),
        
        # Isfahan
        ('میدان نقش جهان', 'اصفهان', 'تاریخی', 32.6577, 51.6776),
        ('کاخ چهلستون', 'اصفهان', 'تاریخی', 32.6572, 51.6720),
        ('عمارت عالی‌قاپو', 'اصفهان', 'تاریخی', 32.6575, 51.6766),
        ('بازار بزرگ اصفهان', 'اصفهان', 'بازار', 32.6619, 51.6778),
        ('مسجد جامع اصفهان', 'اصفهان', 'مذهبی', 32.6697, 51.6853),
        ('مسجد شیخ لطف‌الله', 'اصفهان', 'مذهبی', 32.6574, 51.6785),
        ('سی‌ و سه پل', 'اصفهان', 'تاریخی', 32.6448, 51.6675),
        ('پل خواجو', 'اصفهان', 'تاریخی', 32.6366, 51.6826),
        ('کلیسای وانک', 'اصفهان', 'مذهبی', 32.6352, 51.6558),
        ('منارجنبان', 'اصفهان', 'تاریخی', 32.6496, 51.5973),
        ('بازار قیصریه', 'اصفهان', 'بازار', 32.6586, 51.6777),
        ('باغ فین', 'کاشان', 'تاریخی', 33.9456, 51.4069),

        # Tehran
        ('برج میلاد', 'تهران', 'مدرن', 35.7448, 51.3753),
        ('کاخ گلستان', 'تهران', 'تاریخی', 35.6806, 51.4204),
        ('کاخ سعدآباد', 'شمیرانات', 'تاریخی', 35.8157, 51.4239),
        ('کاخ نیاوران', 'شمیرانات', 'تاریخی', 35.8114, 51.4727),
        ('بام تهران', 'شمیرانات', 'تفریحی', 35.8242, 51.4093),
        ('دربند', 'شمیرانات', 'تفریحی', 35.8242, 51.4269),
        ('توچال', 'شمیرانات', 'طبیعی', 35.8892, 51.4173),
        ('پارک چیتگر', 'تهران', 'طبیعی', 35.7335, 51.2185),
        ('دریاچه چیتگر', 'تهران', 'تفریحی', 35.7483, 51.2168),
        ('پل طبیعت', 'تهران', 'مدرن', 35.7554, 51.4187),
        ('امامزاده صالح', 'شمیرانات', 'مذهبی', 35.8055, 51.4293),

        # Kerman
        ('ارگ بم', 'بم', 'تاریخی', 29.1158, 58.3693),
        ('باغ شاهزاده ماهان', 'ماهان', 'تاریخی', 30.0406, 57.2798),
        ('باغ فتح‌آباد', 'کرمان', 'تاریخی', 30.3475, 56.9634),
        ('مسجد جامع کرمان', 'کرمان', 'مذهبی', 30.2882, 57.0811),
        ('حمام گنجعلی‌خان', 'کرمان', 'تاریخی', 30.2906, 57.0788),
        ('مجموعه گنجعلی‌خان', 'کرمان', 'تاریخی', 30.2906, 57.0788),
        ('بازار بزرگ کرمان', 'کرمان', 'بازار', 30.2900, 57.0800),
        ('آتشکده زرتشتیان کرمان', 'کرمان', 'مذهبی', 30.2965, 57.0740),
        ('کویر لوت شهداد', 'شهداد', 'طبیعی', 30.6000, 58.0000),
        ('کلوت شهداد', 'شهداد', 'طبیعی', 30.6000, 58.0000),
        ('روستای صخره‌ای میمند', 'شهربابک', 'تاریخی', 30.2319, 55.3725),

        # Yazd
        ('باغ دولت‌آباد', 'یزد', 'تاریخی', 31.9023, 54.3547),
        ('آتشکده زرتشتیان یزد', 'یزد', 'مذهبی', 31.8844, 54.3732),
        ('مسجد جامع یزد', 'یزد', 'مذهبی', 31.9011, 54.3705),
        ('یخچال خشتی میبد', 'میبد', 'تاریخی', 32.2275, 54.0150),
        ('قنات زارچ', 'زارچ', 'تاریخی', 31.9500, 54.2500),
        ('آسیاب آبی اشکذر', 'اشکذر', 'تاریخی', 32.0000, 54.2000),

        # Qom
        ('حرم حضرت معصومه', 'قم', 'مذهبی', 34.6417, 50.8790),
        ('مسجد جمکران', 'قم', 'مذهبی', 34.6042, 50.9100),
        ('بازار قدیم قم', 'قم', 'بازار', 34.6400, 50.8800),
        ('مدرسه فیضیه قم', 'قم', 'فرهنگی', 34.6420, 50.8780),
        ('قبرستان شیخان', 'قم', 'مذهبی', 34.6430, 50.8790),
        ('امامزاده هاشم', 'تهران', 'مذهبی', 35.8200, 52.0500), # Commonly associated with road to north

        # Tabriz
        ('بازار تبریز', 'تبریز', 'بازار', 38.0802, 46.2922),
        ('مسجد کبود', 'تبریز', 'مذهبی', 38.0735, 46.3015),

        # Khorasan Razavi
        ('آرامگاه فردوسی', 'مشهد', 'فرهنگی', 36.4851, 59.5317),
        ('آرامگاه نادرشاه افشار', 'مشهد', 'تاریخی', 36.2952, 59.6056),
        ('بازار رضای مشهد', 'مشهد', 'بازار', 36.2843, 59.6171),
        ('آرامگاه خیام نیشابور', 'نیشابور', 'فرهنگی', 36.2007, 58.8234),
        ('آرامگاه عطار نیشابور', 'نیشابور', 'فرهنگی', 36.2000, 58.8100),
        ('آرامگاه کمال‌الملک نیشابور', 'نیشابور', 'فرهنگی', 36.2005, 58.8105),
        ('قنات قصبه گناباد', 'گناباد', 'تاریخی', 34.3464, 58.6946),
        ('کلات نادری', 'کلات', 'تاریخی', 36.9944, 59.7619),
        ('آرامگاه شیخ احمد جامی', 'تربت جام', 'مذهبی', 35.2444, 60.6267),
        ('باغ ملی تربت حیدریه', 'تربت حیدریه', 'طبیعی', 35.2800, 59.2200),
        ('رباط لاری', 'تربت حیدریه', 'تاریخی', 35.2750, 59.2150),

        # Zanjan
        ('گنبد سلطانیه', 'سلطانیه', 'تاریخی', 36.4344, 48.7964),

        # West Azerbaijan
        ('تخت سلیمان', 'تکاب', 'تاریخی', 36.6033, 47.2361),
        ('قره کلیسا', 'چالدران', 'مذهبی', 39.0967, 44.5425),
        ('آرامگاه شمس تبریزی', 'خوی', 'فرهنگی', 38.5600, 44.9600),

        # Kermanshah
        ('طاق بستان', 'کرمانشاه', 'تاریخی', 34.3879, 47.1328),
        ('مجموعه بیستون', 'کرمانشاه', 'تاریخی', 34.3970, 47.4430),
        ('کتیبه بیستون', 'کرمانشاه', 'تاریخی', 34.3970, 47.4430),
        ('بازار سنتی کرمانشاه', 'کرمانشاه', 'بازار', 34.3160, 47.0660),
        ('طاق گرا', 'سرپل ذهاب', 'تاریخی', 34.4300, 46.1200),
        ('غار قوری قلعه', 'روانسر', 'طبیعی', 34.8800, 46.6300),

        # Gilan
        ('روستای ماسوله', 'فومن', 'تاریخی', 37.1550, 48.9906),
        ('قلعه رودخان', 'فومن', 'تاریخی', 37.1086, 49.2393),
        ('تالاب انزلی', 'بندر انزلی', 'طبیعی', 37.4725, 49.4622),
        ('بازار سنتی رشت', 'رشت', 'بازار', 37.2808, 49.5831),

        # Lorestan
        ('قلعه فلک‌الافلاک', 'خرم‌آباد', 'تاریخی', 33.4839, 48.3556),
        ('پل شاپوری خرم‌آباد', 'خرم‌آباد', 'تاریخی', 33.4700, 48.3400),
        ('آبشار بیشه', 'دورود', 'طبیعی', 33.3283, 48.8753),
        ('تنگه شیرز', 'کوهدشت', 'طبیعی', 33.7200, 47.5000),

        # Qazvin
        ('قلعه الموت', 'قزوین', 'تاریخی', 36.4464, 50.5861),
        ('کاروانسرای سعدالسلطنه', 'قزوین', 'تاریخی', 36.2688, 50.0031),
        ('عمارت شهرداری قزوین', 'قزوین', 'تاریخی', 36.2700, 50.0050),

        # Hamedan
        ('غار علی صدر', 'همدان', 'طبیعی', 35.3014, 48.3042),
        ('آرامگاه باباطاهر عریان', 'همدان', 'فرهنگی', 34.8058, 48.5033),
        ('آرامگاه ابوعلی سینا', 'همدان', 'فرهنگی', 34.7909, 48.5150),
        ('تپه هگمتانه', 'همدان', 'تاریخی', 34.8030, 48.5190),
        ('دهکده گردشگری گنجنامه', 'همدان', 'تفریحی', 34.7600, 48.4400),
        ('بازار سنتی همدان', 'همدان', 'بازار', 34.7980, 48.5140),

        # Golestan
        ('برج گنبد کاووس', 'گنبد کاووس', 'تاریخی', 37.2558, 55.1683),
        ('پارک جنگلی نهارخوران گرگان', 'گرگان', 'طبیعی', 36.7830, 54.4500),
        ('کاخ موزه گرگان', 'گرگان', 'فرهنگی', 36.8400, 54.4300),
        ('آبشار کبودوال', 'علی آباد کتول', 'طبیعی', 36.8780, 54.8900),
        ('پارک ملی گلستان', 'گالیکش', 'طبیعی', 37.3500, 55.9800),

        # Hormozgan
        ('جزیره کیش', 'جزیره کیش', 'تفریحی', 26.5383, 53.9822),
        ('ژئوپارک قشم', 'جزیره قشم', 'طبیعی', 26.8500, 55.8000),
        ('دره ستارگان', 'جزیره قشم', 'طبیعی', 26.8900, 55.7200),
        ('دره تندیس‌ها قشم', 'جزیره قشم', 'طبیعی', 26.8500, 55.8200),
        ('جنگل حرای قشم', 'جزیره قشم', 'طبیعی', 26.8330, 55.5600),
        ('روستای لافت', 'جزیره قشم', 'تاریخی', 26.9000, 55.7600),
        ('جزیره هنگام', 'جزیره قشم', 'طبیعی', 26.6500, 55.8600),
        ('جزیره لارک', 'جزیره لارک', 'طبیعی', 26.8530, 56.3500),
        ('معبد هندوها', 'بندرعباس', 'تاریخی', 27.1860, 56.2770),
        ('بازار ماهی‌فروشان بندرعباس', 'بندرعباس', 'بازار', 27.1800, 56.2700),
        
        # Bushehr
        ('بندر سیراف', 'بندر سیراف', 'تاریخی', 27.6660, 52.3400),

        # Ardabil
        ('آرامگاه شیخ صفی‌الدین اردبیلی', 'اردبیل', 'تاریخی', 38.2514, 48.2933),
        ('دریاچه نئور', 'اردبیل', 'طبیعی', 38.0000, 48.5600),

        # Khuzestan
        ('زیگورات چغازنبیل', 'شوش', 'تاریخی', 32.0089, 48.5211),
        ('محوطه باستانی شوش', 'شوش', 'تاریخی', 32.1894, 48.2475),
        ('کاخ آپادانا شوش', 'شوش', 'تاریخی', 32.1890, 48.2470),
        ('سازه‌های آبی شوشتر', 'شوشتر', 'تاریخی', 32.0450, 48.8550),
        ('آبشار شوی دزفول', 'دزفول', 'طبیعی', 32.8000, 48.8000),

        # Sistan and Baluchestan
        ('شهر سوخته زابل', 'زابل', 'تاریخی', 30.8350, 61.3500),
        ('آتشکده کرکویه', 'زابل', 'تاریخی', 30.9500, 61.4000),

        # Mazandaran
        ('تالاب میانکاله', 'بهشهر', 'طبیعی', 36.8333, 53.4167),
        ('دریاچه ولشت', 'کلاردشت', 'طبیعی', 36.5333, 51.2833),
        ('روستای کندلوس', 'نوشهر', 'تاریخی', 36.4000, 51.5000),
        ('پارک جنگلی سیسنگان', 'نوشهر', 'طبیعی', 36.5800, 51.8100),
        ('روستای فیلبند', 'بابل', 'طبیعی', 36.1500, 52.5000),

        # Markazi
        ('قلعه دختر ساوه', 'ساوه', 'تاریخی', 35.0000, 50.3500),
        ('روستای هزاوه', 'اراک', 'تاریخی', 34.1500, 49.5600),

        # Kurdistan
        ('دریاچه زریوار', 'مریوان', 'طبیعی', 35.5333, 46.1333),
        ('غار کرفتو', 'دیواندره', 'تاریخی', 36.2667, 46.8667),
        ('بازار سنندج', 'سنندج', 'بازار', 35.3100, 47.0000),
        ('حمام شیشه سنندج', 'سنندج', 'تاریخی', 35.3120, 47.0020),
        ('منطقه اورامان', 'سروآباد', 'طبیعی', 35.2500, 46.3600),
        ('سنگ نبشته اورامان', 'سروآباد', 'تاریخی', 35.2500, 46.3600),

        # South Khorasan
        ('قلعه بیرجند', 'بیرجند', 'تاریخی', 32.8800, 59.2200),
        ('عمارت کلاه فرنگی بیرجند', 'بیرجند', 'تاریخی', 32.8700, 59.2100),
        ('باغ اکبرآباد بیرجند', 'بیرجند', 'تاریخی', 32.8600, 59.2300),
        ('روستای ماخونیک', 'سربیشه', 'فرهنگی', 32.4500, 60.4000),

        # North Khorasan
        ('روستای پاقلعه بجنورد', 'بجنورد', 'طبیعی', 37.4700, 57.3200),

        # Chaharmahal and Bakhtiari
        ('روستای سر آقا سید', 'کوهرنگ', 'فرهنگی', 32.4800, 49.9500),

        # Semnan
        ('مسجد جامع سمنان', 'سمنان', 'مذهبی', 35.5700, 53.3900),
        ('عمارت و باغ امیر سمنان', 'سمنان', 'تاریخی', 35.5750, 53.3950),

        # Ilam
        ('قلعه والی', 'ایلام', 'تاریخی', 33.6300, 46.4100),

        # Alborz
        ('خانه دکتر مصدق', 'نظرآباد', 'تاریخی', 35.9500, 50.6000),
    ]

    for title, city, cat, lat, lon in places_data:
        create_place(title, city, cat, lat, lon)


class Migration(migrations.Migration):

    dependencies = [
        ('tourism', '0002_populate_geography'),
    ]

    operations = [
        migrations.RunPython(populate_places),
    ]